<!--/******
 * VISUALISIERUNG 1
 * Author: Mina Schütz (730205), Max Röthig, Laura Puchinger
 * Gruppe: OH_DA Hochschule Darmstadt, 
 * Sommersemester 2018
 * Projekt: Visual Forecast Analytics
 * Betreuer: Prof. Dr. Ing.- Kawa Nazemi
*****/
//https://github.com/d3/d3/wiki/tutorials - turoials d3
//http://api.vissights.net/databases - databases
-->
<!DOCTYPE html>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>

<html lang="en">
<head>
</head>
<body>

<script>
$(document).ready(function(){
$.ajax({
                url: "http://api.vissights.net/semaservice-web-api-vissights/v2/springer/author/search?authorname=Melanie%20Siegel",
				type: 'GET',
				success: function (person){
					//wir brauchen: 1 array mit topics + wie oft sie vorkommen und 2 array co-autoren 
					//und wie oft sie vorkommen, damit splitten wir die treemap in a) topics und quanitity und b) co-athours und quantity
					var name = [];
					var name2 = [];
					var topicse = [];
					var topicse2 = [];		
					for (var i = 0; i < person.length; i++) {
						if (person[i].author != "Melanie Siegel"){ //platzhalter, hier vll in zukunft das was in der suchleiste steht einfügen
							name.push({ name:(person[i].author)});
						}
					}
					for (var i = 0; i < person.length; i++) {
							topicse.push({topicS: person[i].topics}, {topicSum: Object.keys(person[i].topics).length});
							
					}
					const singleArrTopics = topicse.reduce((total, amount) => {
						amount.topics.forEach( topics => {
							total.push(topics);
						})
						return total;
					}, [])
						
					var resTopic = topicse.reduce(function(result, topicS){
						for (var key in topicS){
							if (topicS.hasOwnProperty(key)){
								result[key] = topicS[key];
							}
						}
					return result;
					}, {});
					topicse.sort();
					//console.log(name);
					console.log(topicse);
					console.log(singleArrTopic);
					console.log(resTopic);
					}						
});
//var c10 = d3.scale.category20b(); funktioniert nicht, ka warum

function niceTreeMap (topicse){
		
	//hier muss ich nur wissen warum ich im browser nichts sehe
	var svg = d3.select("svg"),
		width = +svg.attr("width"),
		height = +svg.attr("height");
		
	var canvas = d3.select("body").append("svg")
		.attr("width", 1000)
		.attr("height", 1000);
		
	var fader = function(color) { 
			return d3.interpolateRgb(color, "#fff")(0.2); 
			},
		color = d3.scaleOrdinal(d3.schemeCategory20.map(fader)),
		format = d3.format(",d");
		
	var treemap = d3.treemap()
		.tile(d3.treemapResquarify)
		.size([width, height])
		.round(true)
		.paddingInner(1);
		
	var cells = canvas.selectALL(".cell")
		.data(treemap)
		.enter()
		.append("g")
		.attr("class", "cell")
		
	cells.append("rect")
		.attr("x", 200)
		.attr("y", 200)
		.attr("width", 300)
		.attr("height", 300)
		.attr("fill", "#4C0B5F");
		
	d3.selectAll("input")
      .data([sumBySize, sumByCount], function(d) { return d ? d.name : this.value; })	
	
console.log(treemap);	
};
niceTreeMap();
console.log("Hallo");
});
</script>
<div id="canvas">
</div>
</body>
</html>
